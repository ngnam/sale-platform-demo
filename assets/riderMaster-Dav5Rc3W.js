import"./menu-KmJeyBmp.js";import{n as e,t}from"./_plugin-vue_export-helper-DjLyun5i.js";import{a as n,i as r,o as i,t as a}from"./input-Dl58X2zG.js";import{t as o}from"./table-B5NlV_bM.js";import{r as s,t as c}from"./select-qwNyy2X6.js";import{o as l}from"./Col-Dn_WxAuq.js";import"./FolderOutlined-CuOYp4hi.js";import"./EyeInvisibleOutlined-DQ7XOaOB.js";import{t as u}from"./modal-7zbmb4iA.js";import"./move-BV2dG8Yt.js";import"./checkbox-DTOnil2W.js";import{t as d}from"./page-header-oerFmpyY.js";import{t as f}from"./space-BwjoyeVf.js";import"./dropdown-BjYLSNDe.js";import"./breadcrumb-bZrN7p1V.js";import"./spin-CjGf5sPd.js";import"./ArrowRightOutlined-jL2ruyWB.js";import{t as p}from"./popconfirm-Mr8MyDf8.js";import{Bn as m,Cn as h,Dn as g,En as _,Qn as v,Sn as y,Tn as b,Un as x,_n as S,ir as C,kn as w,pr as T,rr as E,u as D,ur as O,xn as k}from"./index-DNW3ueIJ.js";import{t as A}from"./rider-LIyi9SzS.js";var j={style:{display:`flex`,gap:`8px`,"align-items":`center`}},M={key:1},N=t(w({__name:`index`,setup(t){let w=C(``),N=C([]),P=C(!1),F=C(!1),I=C(!1),L=C(!1),R=E({riderCode:``,name:``,basis:void 0}),z=[{title:`Mã Rider`,dataIndex:`riderCode`,key:`riderCode`},{title:`Tên`,dataIndex:`name`,key:`name`},{title:`Cơ sở`,dataIndex:`basis`,key:`basis`},{title:`Hành động`,key:`action`,fixed:`right`,width:160}],B=k(()=>L.value?`Sửa Rider ${R.riderCode}`:`Tạo Rider mới`);function V(e){H()}async function H(){P.value=!0;try{let e=await A.queryMasters(w.value||void 0);N.value=e.data??e??[]}catch(e){console.error(e),D.error(`Tải danh sách Rider thất bại`)}finally{P.value=!1}}function U(e){e?(L.value=!0,R.riderCode=e.riderCode,R.name=e.name,R.basis=e.basis??void 0):(L.value=!1,R.riderCode=``,R.name=``,R.basis=void 0),F.value=!0}async function W(){I.value=!0;try{if(!R.riderCode||!R.name){D.warn(`Mã và tên là bắt buộc`);return}if(L.value){let e={name:R.name,basis:R.basis??void 0};await A.updateMaster(R.riderCode,e),D.success(`Cập nhật Rider thành công`)}else{let e={riderCode:R.riderCode,name:R.name,basis:R.basis??void 0};await A.createMaster(e),D.success(`Tạo Rider thành công`)}F.value=!1,await H()}catch(e){console.error(e),D.error(e?.message??`Lưu thất bại`)}finally{I.value=!1}}async function G(e){try{await A.deleteMaster(e),D.success(`Xóa thành công`),await H()}catch(e){console.error(e),D.error(e?.message??`Xóa thất bại`)}}return m(()=>H()),(t,m)=>{let C=d,E=r,D=e,k=l,A=p,K=f,q=o,J=a,Y=i,X=c,Z=s,Q=n,$=u;return x(),b(S,null,[g(C,{title:`Quản lý Phụ trợ bảo hiểm`}),g(k,{class:`mb12`},{default:v(()=>[y(`div`,j,[g(E,{value:w.value,"onUpdate:value":m[0]||=e=>w.value=e,placeholder:`Tìm theo mã hoặc tên`,onSearch:V,style:{width:`320px`},allowClear:``},null,8,[`value`]),g(D,{type:`primary`,onClick:m[1]||=e=>U()},{default:v(()=>[...m[7]||=[_(`Tạo Rider`,-1)]]),_:1}),g(D,{onClick:H},{default:v(()=>[...m[8]||=[_(`Làm mới`,-1)]]),_:1})])]),_:1}),g(k,{title:`Danh sách Rider`,class:`mb12`},{default:v(()=>[g(q,{columns:z,dataSource:N.value,rowKey:e=>e.riderCode,pagination:!1,loading:P.value,scroll:{x:1400,y:500}},{bodyCell:v(({column:e,record:t})=>[e.key===`action`?(x(),h(K,{key:0,style:{"justify-content":`flex-end`,width:`100%`}},{default:v(()=>[g(D,{size:`small`,onClick:e=>U(t)},{default:v(()=>[...m[9]||=[_(`Sửa`,-1)]]),_:1},8,[`onClick`]),g(A,{title:`Xóa rider này?`,onConfirm:()=>G(t.riderCode)},{default:v(()=>[g(D,{size:`small`,danger:``},{default:v(()=>[...m[10]||=[_(`Xóa`,-1)]]),_:1})]),_:1},8,[`onConfirm`])]),_:2},1024)):(x(),b(`span`,M,T(t[e.dataIndex]),1))]),_:1},8,[`dataSource`,`rowKey`,`loading`])]),_:1}),g($,{open:F.value,"onUpdate:open":m[5]||=e=>F.value=e,title:O(B),onOk:W,onCancel:m[6]||=e=>F.value=!1,confirmLoading:I.value},{default:v(()=>[g(Q,{layout:`vertical`},{default:v(()=>[g(Y,{label:`Mã Rider`},{default:v(()=>[g(J,{value:R.riderCode,"onUpdate:value":m[2]||=e=>R.riderCode=e,disabled:L.value},null,8,[`value`,`disabled`])]),_:1}),g(Y,{label:`Tên`},{default:v(()=>[g(J,{value:R.name,"onUpdate:value":m[3]||=e=>R.name=e},null,8,[`value`])]),_:1}),g(Y,{label:`Cơ sở tính`},{default:v(()=>[g(Z,{value:R.basis,"onUpdate:value":m[4]||=e=>R.basis=e,allowClear:``},{default:v(()=>[g(X,{value:`per_1000`},{default:v(()=>[...m[11]||=[_(`per_1000`,-1)]]),_:1}),g(X,{value:`per_unit`},{default:v(()=>[...m[12]||=[_(`per_unit`,-1)]]),_:1}),g(X,{value:`percent_of_base`},{default:v(()=>[...m[13]||=[_(`percent_of_base`,-1)]]),_:1})]),_:1},8,[`value`])]),_:1})]),_:1})]),_:1},8,[`open`,`title`,`confirmLoading`])],64)}}}),[[`__scopeId`,`data-v-0964c971`]]);export{N as default};