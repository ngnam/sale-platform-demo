import{o as e,t}from"./menu-KmJeyBmp.js";import{n,t as r}from"./_plugin-vue_export-helper-DjLyun5i.js";import{a as i,i as a,o,s}from"./input-Dl58X2zG.js";import{i as c,t as l}from"./table-B5NlV_bM.js";import{r as u}from"./select-qwNyy2X6.js";import{o as d}from"./Col-Dn_WxAuq.js";import{t as f}from"./modal-7zbmb4iA.js";import{t as p}from"./checkbox-DTOnil2W.js";import{t as m}from"./space-BwjoyeVf.js";import{n as h,t as g}from"./row-DAVpSNuc.js";import{t as _}from"./date-picker-ekm1N11q.js";import{t as v}from"./popconfirm-Mr8MyDf8.js";import{Bn as y,Cn as b,Dn as x,En as S,Gn as C,Mn as w,Pn as T,Qn as E,Sn as D,Tn as O,Un as k,Vn as A,Xn as j,Zn as M,_n as N,ar as P,b as F,dr as ee,f as te,fr as ne,gr as re,h as ie,hn as ae,ir as I,jn as oe,kn as se,l as ce,ln as le,or as L,p as ue,pr as R,rr as de,tr as fe,u as pe,ur as me,wn as z,xn as B}from"./index-DNW3ueIJ.js";import{t as he}from"./Icon-LsJhdwkb.js";import{n as ge,t as _e}from"./dateUtil-Dnzq1uhr.js";var ve={__name:`index`,props:{modelValue:[String,Number,Object],placeholder:{type:String,default:`Select user`},pageSize:{type:Number,default:10},fetchApiUsers:{type:Function,required:!0},labelKey:{type:String,default:`name`},valueKey:{type:String,default:`id`},mode:{type:String,default:void 0}},emits:[`update:modelValue`],setup(e,{expose:t,emit:n}){let r=e,i=n,a=I(r.modelValue),o=I([]),c=I(!1),l=I(``),d=I(1),f=I(!0);j(()=>r.modelValue,e=>{a.value=e}),y(async()=>{console.log(`onMounted`),await h()});let p=async e=>{e&&await h()},m=B(()=>o.value.map(e=>({label:e[r.labelKey],value:e[r.valueKey]}))),h=async e=>{l.value=e||null,d.value=1,f.value=!0,o.value=[],await v()};t({refresh:h});let g=s(h,1e3*1),_=async e=>{let{scrollTop:t,scrollHeight:n,clientHeight:r}=e.target;t+r>=n-10&&f.value&&!c.value&&await v()},v=async()=>{c.value=!0;try{let e=await r.fetchApiUsers(l.value,d.value,r.pageSize);Array.isArray(e)&&e.length>0?(o.value.push(...e),f.value=e.length===r.pageSize,d.value+=1):f.value=!1}catch(e){console.error(`Error fetching users:`,e),f.value=!1}finally{c.value=!1}},x=e=>{i(`update:modelValue`,e)};return(t,n)=>{let r=u;return k(),b(r,{value:a.value,"onUpdate:value":n[0]||=e=>a.value=e,placeholder:e.placeholder,"show-search":``,"filter-option":!1,options:me(m),loading:c.value,onSearch:me(g),onPopupScroll:_,onChange:x,mode:e.mode,virtual:!1,onDropdownVisibleChange:p},null,8,[`value`,`placeholder`,`options`,`loading`,`onSearch`,`mode`])}}},ye=se({props:[`hiddenFilter`,`button`,`items`,`model`,`rowSelection`,`isExportExcel`,`buttons`],emits:[`onSearch`,`onDeselect`,`onDeleteAll`,`onExportExcel`],setup(e,{emit:t}){let n=de(e.model||{}),r=B(()=>(e.items||[]).map(e=>({type:`input`,...e}))),i=B(()=>(e.buttons||[]).map(e=>({type:`default`,...e}))),a=()=>{t(`onSearch`)},o=I(e.hiddenFilter),s=B(()=>e.rowSelection?e.rowSelection.selectedRowKeys:[]);M(()=>{!e.button&&!e.items&&(o.value=!0)});let c=B(()=>({...L(e.button)||{},permission:!0}));return{formModel:n,getItems:r,getButtons:i,hasHidden:o,getButton:c,handleSubmit:a,selectedRowKeys:s,handleDeselect:()=>{t(`onDeselect`)},handleDeleteAll:()=>{t(`onDeleteAll`)},handleExportExcel:()=>{t(`onExportExcel`)}}}}),be={style:{"margin-left":`16px`,"font-weight":`600`}},xe={key:0,class:`text`};function Se(e,t,r,s,c,l){let f=u,v=_,y=p,w=ve,A=n,j=a,M=o,P=m,F=h,ee=g,te=i,re=d;return e.hasHidden?z(``,!0):(k(),b(re,{key:0,"body-style":{marginBottom:`5px`,padding:`24px 24px 0 24px`},bordered:!1},{default:E(()=>[x(te,{class:`form-container`,layout:`horizontal`,model:e.formModel},{default:E(()=>[x(ee,{type:`flex`},{default:E(()=>[x(F,{flex:`100px`},{default:E(()=>[x(P,null,{default:E(()=>[(k(!0),O(N,null,C(e.getItems,n=>(k(),b(M,{key:n.name,name:n.name},{default:E(()=>[n.type===`select`?(k(),b(f,T({key:`select-${n.name}`},{ref_for:!0},n,{value:e.formModel[n.name],"onUpdate:value":t=>e.formModel[n.name]=t,class:`default-select-w`}),null,16,[`value`,`onUpdate:value`])):n.type===`date`?(k(),b(v,T({key:`date-${n.name}`},{ref_for:!0},n,{value:e.formModel[n.name],"onUpdate:value":t=>e.formModel[n.name]=t,class:`default-select-w`}),null,16,[`value`,`onUpdate:value`])):n.type===`checkbox`?(k(),b(y,T({key:`checkbox-${n.name}`},{ref_for:!0},n,{checked:e.formModel[n.name],"onUpdate:checked":t=>e.formModel[n.name]=t,class:`default-select-w`}),{default:E(()=>[S(R(e.formModel[n.name]?`Active`:`Inactive`),1)]),_:2},1040,[`checked`,`onUpdate:checked`])):n.type===`lazyselect`?(k(),b(w,T({key:`lazyselect-${n.name}`,modelValue:e.formModel[n.name],"onUpdate:modelValue":t=>e.formModel[n.name]=t},{ref_for:!0},n,{class:`default-select-w`}),null,16,[`modelValue`,`onUpdate:modelValue`])):(k(),b(j,T({key:4,ref_for:!0},n,{key:`input-${n.name}`,value:e.formModel[n.name],"onUpdate:value":t=>e.formModel[n.name]=t,onSearch:e.handleSubmit,class:`default-search-w`}),{enterButton:E(()=>[x(A,{type:`primary`},{default:E(()=>[...t[1]||=[S(`Search`,-1)]]),_:1})]),_:1},16,[`value`,`onUpdate:value`,`onSearch`]))]),_:2},1032,[`name`]))),128))]),_:1})]),_:1}),e.selectedRowKeys.length>0?(k(),b(F,{key:0,flex:`auto`,class:`rowS`},{default:E(()=>[D(`span`,be,R(`${e.selectedRowKeys.length} Selected`),1),D(`span`,{style:ne([{"margin-left":`8px`,"margin-right":`8px`},{"text-decoration":`underline`,color:`#0065BD`,fontWeight:600}]),onClick:t[0]||=(...t)=>e.handleDeselect&&e.handleDeselect(...t)},`Deselect`),x(A,{style:{"margin-left":`8px`},type:`primary`,danger:``,onClick:e.handleDeleteAll},{default:E(()=>[...t[2]||=[S(R(`Delete`),-1)]]),_:1},8,[`onClick`])]),_:1})):z(``,!0),e.button||e.buttons?(k(),b(F,{key:1,flex:`auto`,class:`rowE`,style:{gap:`5px`}},{default:E(()=>[e.button.type===`text`?(k(),O(`span`,xe,R(e.button.label),1)):z(``,!0),e.getButton.permission?(k(),b(A,T({key:1},e.button,{onClick:e.button?.onClick}),{default:E(()=>[S(R(e.button.label),1)]),_:1},16,[`onClick`])):z(``,!0),e.isExportExcel&&e.getButton.permission?(k(),b(A,{key:2,type:`default`,style:{"margin-left":`10px`},onClick:e.handleExportExcel},{default:E(()=>[...t[3]||=[S(`Export to Excel`,-1)]]),_:1},8,[`onClick`])):z(``,!0),(k(!0),O(N,null,C(e.getButtons,e=>(k(),O(N,{key:e.label},[e?(k(),b(A,T({key:0,ref_for:!0},e,{onClick:e?.onClick}),{default:E(()=>[S(R(e.label),1)]),_:2},1040,[`onClick`])):z(``,!0)],64))),128))]),_:1})):z(``,!0)]),_:1})]),_:1},8,[`model`])]),_:1}))}var Ce=r(ye,[[`render`,Se],[`__scopeId`,`data-v-f466728c`]]),we={},Te=Symbol(`GLOBAL_OPTIONS_PROVIDE_KEY`),Ee=()=>we,V=e=>e,De=Object.prototype.toString,Oe=e=>De.call(e),ke=e=>Oe(e)===`[object Object]`,H=e=>Array.isArray(e),U=e=>typeof e==`object`&&!!e,W=e=>e instanceof Function,G=e=>e==null,K=typeof window>`u`,Ae=()=>K||G(window.document?.visibilityState)?!0:window.document.visibilityState===`visible`,je=()=>(!K&&window.navigator?.onLine)??!0,q=()=>new Promise(()=>{}),Me=function(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,r=t.replace(/\[(\d+)\]/g,`.$1`).split(`.`),i=e;for(let e of r)if(i=Object(i)[e],i===void 0)return n;return i},J=e=>fe(e)?e.value:e,Ne=e=>U(e)?Object.assign(H(e)?[]:{},e):e,Y=new Map,Pe=e=>{if(!G(e))return Y.get(e)},Fe=(e,t,n)=>{let r=Y.get(e);r!=null&&r.timer&&clearTimeout(r.timer);let i=setTimeout(()=>Y.delete(e),t);Y.set(e,{...n,timer:i})};function Ie(e,t,n){let r,i,a,o,s,c,l=0,u=!1,d=!1,f=!0,p=!t&&t!==0&&typeof window.requestAnimationFrame==`function`;if(typeof e!=`function`)throw TypeError(`Expected a function`);t=+t||0,U(n)&&(u=!!n.leading,d=`maxWait`in n,a=d?Math.max(+n.maxWait||0,t):a,f=`trailing`in n?!!n.trailing:f);function m(t){let n=r,a=i;return r=i=void 0,l=t,o=e.apply(a,n),o}function h(e,t){return p?(window.cancelAnimationFrame(s),window.requestAnimationFrame(e)):setTimeout(e,t)}function g(e){if(p)return window.cancelAnimationFrame(e);clearTimeout(e)}function _(e){return l=e,s=h(b,t),u?m(e):o}function v(e){let n=e-c,r=e-l,i=t-n;return d?Math.min(i,a-r):i}function y(e){let n=e-c,r=e-l;return c===void 0||n>=t||n<0||d&&r>=a}function b(){let e=Date.now();if(y(e))return x(e);s=h(b,v(e))}function x(e){return s=void 0,f&&r?m(e):(r=i=void 0,o)}function S(){s!==void 0&&g(s),l=0,r=c=i=s=void 0}function C(){return s===void 0?o:x(Date.now())}function w(){return s!==void 0}function T(){let e=Date.now(),n=y(e);if(r=[...arguments],i=this,c=e,n){if(s===void 0)return _(c);if(d)return s=h(b,t),m(c)}return s===void 0&&(s=h(b,t)),o}return T.cancel=S,T.flush=C,T.pending=w,T}function Le(e,t){for(let n in t){if(t[n]===void 0)continue;if(!U(t[n])||!U(e[n])||!(n in e)){e[n]=t[n];continue}(ke(t[n])||H(t[n]))&&Le(e[n],t[n])}}function Re(e){let t=Object.assign({},e);var n=[...arguments].slice(1);if(!n.length)return t;for(let e of n)Le(t,e);return t}function ze(e,t,n){let r=!0,i=!0;if(typeof e!=`function`)throw TypeError(`Expected a function`);return U(n)&&(r=`leading`in n?!!n.leading:r,i=`trailing`in n?!!n.trailing:i),Ie(e,t,{leading:r,trailing:i,maxWait:t})}var Be=V((e,t)=>{let{debounceInterval:n,debounceOptions:r,manual:i}=t,a=I(!1),o=I(),s=B(()=>r),c=B(()=>J(n)),l=I(e.context.runAsync);return i||(a.value=!0),M(t=>{G(c.value)||(o.value=Ie(e=>e(),c.value,s.value),e.context.runAsync=function(){var e=[...arguments];return new Promise((t,n)=>{a.value?(a.value=!1,l.value(...e).then(t).catch(n)):o.value(()=>{l.value(...e).then(t).catch(n)})})},t(()=>{var t;(t=o.value)==null||t.cancel(),e.context.runAsync=l.value}))}),{onCancel(){var e;(e=o.value)==null||e.cancel()}}}),Ve=V((e,t)=>{let{errorRetryCount:n=0,errorRetryInterval:r=0}=t,i=I(),a=I(0),o=B(()=>J(n)),s=B(()=>J(r)),c=!1,l=()=>{a.value=0},u=B(()=>s.value?s.value:1e3*Math.floor(Math.random()*2**Math.min(a.value,9)+1)),d=()=>{let t,n=o.value===-1,r=a.value<o.value;return(n||r)&&(n||(a.value+=1),t=setTimeout(()=>{c=!0,e.context.refresh()},u.value)),()=>t&&clearTimeout(t)},f=()=>{i.value&&i.value()};return{onBefore(){c||l(),c=!1,f()},onSuccess(){l()},onError(){i.value=d()},onCancel(){l(),f()}}}),He=V((e,t)=>{let{ready:n=I(!0),manual:r,defaultParams:i=[]}=t;return j(n,t=>{!r&&t&&e.context.run(...i)},{flush:`sync`}),{onBefore(){if(!(W(n)?n():n.value))return e.loading.value=!1,{isBreak:!0}}}}),Ue=V((e,t)=>{let{refreshDeps:n,refreshDepsAction:r,manual:i}=t;if(n===void 0||H(n)&&n.length===0)return{};let a=H(n)?n:[n];return j(a,()=>{r?r():!i&&e.context.refresh()}),{}}),We=V((e,t)=>{let{throttleInterval:n,throttleOptions:r}=t,i=I(),a=B(()=>J(n)),o=B(()=>r),s=I(e.context.runAsync);return M(t=>{if(G(n))return{};i.value=ze(e=>e(),a.value,o.value),e.context.runAsync=function(){var e=[...arguments];return new Promise((t,n)=>{i.value(()=>{s.value(...e).then(t).catch(n)})})},t(()=>{var t;(t=i.value)==null||t.cancel(),e.context.runAsync=s.value})}),{onCancel(){var e;(e=i.value)==null||e.cancel()}}}),Ge=(e,t)=>n=>{Object.keys(n).forEach(t=>{e[t].value=n[t]}),t.forEach(t=>t(e))},Ke=(e,t)=>()=>{let n=t;for(let t=e.length;t-- >0;)n=e[t](n);return n()},qe=(e,t,n)=>{let{initialData:r,onSuccess:i,onError:a,onBefore:o,onAfter:s}=t,c=I(n?.loading??!1),l=P(n?.data??r),u=P(n?.error),d=I(n?.params),f=I([]),p=P(`pending`),m={},h=Ge({status:p,loading:c,data:l,error:u,params:d},[]),g=function(e){var t=[...arguments].slice(1);if(e===`onQuery`){let e=f.value.map(e=>e.onQuery).filter(Boolean);return{servicePromise:Ke(e,t[0])()}}else{let n=f.value.map(n=>n[e]?.call(n,...t));return Object.assign({},...n)}},_=I(0);return m.runAsync=async function(){var t=[...arguments];h({loading:!0,params:t,status:`pending`}),_.value+=1;let n=_.value,{isBreak:r,breakResult:c=q()}=g(`onBefore`,t);if(r)return h({status:`settled`}),c;o?.(t);try{let r=()=>new Promise(t=>t(e(...d.value))),{servicePromise:a}=g(`onQuery`,r);a||=r();let o=await a;return n===_.value?(h({data:o,loading:!1,error:void 0,status:`settled`}),g(`onSuccess`,o,t),i?.(o,t),n===_.value&&g(`onAfter`,t,o,void 0),s?.(t),o):q()}catch(e){if(n!==_.value)return q();throw h({loading:!1,error:e,status:`settled`}),g(`onError`,e,t),a?.(e,t),n===_.value&&g(`onAfter`,t,void 0,e),s?.(t),e}},m.run=function(){m.runAsync(...arguments).catch(e=>{a||console.error(e)})},m.cancel=()=>{_.value+=1,h({loading:!1}),g(`onCancel`)},m.refresh=()=>{m.run(...d.value||[])},m.refreshAsync=()=>m.runAsync(...d.value||[]),m.mutate=e=>{let t=W(e)?e(l.value):e,n=Ne(t);h({data:n}),g(`onMutate`,n)},{status:p,loading:c,data:l,error:u,params:d,plugins:f,context:m}};function Je(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=w(Te,{}),i={...Ee(),...r,...t},{manual:a=!1,defaultParams:o=[]}=i,s=qe(e,i);if(s.plugins.value=n.map(e=>e(s,i)),!a){let e=s.params.value||o;s.context.run(...e)}return A(()=>{s.context.cancel()}),{loading:s.loading,data:s.data,error:s.error,params:s.params,cancel:s.context.cancel,refresh:s.context.refresh,refreshAsync:s.context.refreshAsync,mutate:s.context.mutate,run:s.context.run,runAsync:s.context.runAsync}}var X=new Map,Ye=(e,t)=>{X.set(e,t),t.then(t=>(X.delete(e),t)).catch(()=>{X.delete(e)})},Xe=e=>X.get(e),Z=new Map,Ze=(e,t)=>{Z.has(e)&&Z.get(e).forEach(e=>e(t))},Qe=(e,t)=>(Z.has(e)?Z.get(e).push(t):Z.set(e,[t]),()=>{let n=Z.get(e).indexOf(t);Z.get(e).splice(n,1)}),$e=V((e,t)=>{let{cacheKey:n,cacheTime:r=6e5,staleTime:i=0,getCache:a,setCache:o}=t;if(!n)return{};let s=W(n)?n:()=>n,c=I(()=>{}),l,u=e=>a?a(e):Pe(e),d=(e,t,n)=>{o?o(e,n):Fe(e,t,n),Ze(e,n.data)},f=e=>i===-1||e+i>new Date().getTime(),p=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),m=t=>{let n=s(t);return Qe(n,t=>{e.data.value=t})},h=s(),g=u(h);return g&&p(g,`data`)&&(e.data.value=g.data,e.params.value=g.params),h&&(c.value=m()),A(()=>{c.value()}),{onBefore(t){let n=s(t),r=u(n);if(!r||!p(r,`data`))return{};if(f(r.time))return e.data.value=r.data,e.loading.value=!1,{isBreak:!0,breakResult:r.data};e.data.value=r.data},onQuery(t){let n=e.params.value,r=s(n),i=Xe(r);return i&&i!==l?()=>i:(i=t(),l=i,Ye(r,i),()=>i)},onSuccess(e,t){let n=s(t);n&&(c.value(),d(n,r,{data:e,params:t,time:new Date().getTime()}),c.value=m(t))},onMutate(t){let n=s(e.params.value);n&&(c.value(),d(n,r,{data:t,params:e.params.value,time:new Date().getTime()}),c.value=m(e.params.value))}}});function et(e){let t,n;class r extends Promise{constructor(e){super(e),this.cancel=()=>{n(),clearTimeout(t)}}}return new r(r=>{n=r,t=setTimeout(n,e)})}function tt(){return new Date().getTime()}var nt=V((e,t)=>{let{loadingDelay:n=0,loadingKeep:r=0}=t,i=I(()=>{}),a=B(()=>J(n)),o=B(()=>J(r)),s=0,c={},l=()=>{let t;return a.value&&(t=setTimeout(()=>{e.status.value===`pending`&&(e.loading.value=!0)},a.value)),()=>t&&clearTimeout(t)};return{onBefore(){e.loading.value=!a.value,i.value(),i.value=l(),s=tt()},onQuery(e){if(!o.value)return()=>e();c=et(o.value+a.value);let t=Promise.allSettled([(async()=>{try{let t=await e();return tt()-s<=a.value&&c.cancel(),Promise.resolve(t)}catch(e){return tt()-s<=a.value&&c.cancel(),Promise.reject(e)}})(),c]).then(e=>{let t=e[0];return t.status===`fulfilled`?t.value:Promise.reject(t.reason)});return()=>t},onCancel(){i.value()},onAfter(){i.value()}}}),rt,it=new Set,at=new Set,ot=new Set,Q=(e,t)=>{let n;switch(e){case`FOCUS_LISTENER`:n=it;break;case`RECONNECT_LISTENER`:n=ot;break;case`VISIBLE_LISTENER`:n=at;break}if(!n.has(t))return n.add(t),()=>{n.delete(t)}},st=e=>{e.forEach(e=>{e()})};!K&&(rt=window)!=null&&rt.addEventListener&&(window.addEventListener(`visibilitychange`,()=>{Ae()&&st(at)},!1),window.addEventListener(`focus`,()=>st(it),!1),window.addEventListener(`online`,()=>st(ot),!1));var ct=V((e,t)=>{let{pollingInterval:n,pollingWhenHidden:r=!1,pollingWhenOffline:i=!1,errorRetryCount:a=0}=t,o=I(),s=I(!1),c=B(()=>J(n)),l=B(()=>J(a)),u=[],d=e=>{e&&u.push(e)},f=()=>(r||Ae())&&(i||je()),p=t=>{if(e.error.value&&l.value!==0)return;let n;if(!G(c.value)&&c.value>=0)if(f())n=setTimeout(t,c.value);else{s.value=!0;return}return()=>n&&clearTimeout(n)},m=()=>{s.value&&f()&&(e.context.refresh(),s.value=!1)};return j(c,()=>{o.value&&=(o.value(),p(()=>e.context.refresh()))}),r||d(Q(`VISIBLE_LISTENER`,m)),i||d(Q(`RECONNECT_LISTENER`,m)),A(()=>{u.forEach(e=>e())}),{onBefore(){var e;(e=o.value)==null||e.call(o)},onCancel(){var e;(e=o.value)==null||e.call(o)},onAfter(){o.value=p(()=>e.context.refresh())}}}),lt=(e,t)=>{let n=!1;return function(){n||(n=!0,e(...arguments),setTimeout(()=>{n=!1},t))}},ut=V((e,t)=>{let{refreshOnWindowFocus:n=!1,refocusTimespan:r=5e3}=t,i=B(()=>J(n)),a=B(()=>J(r)),o=[],s=e=>{e&&o.push(e)},c=()=>{o.forEach(e=>e())};return M(()=>{if(c(),i.value){let t=lt(e.context.refresh,a.value);s(Q(`VISIBLE_LISTENER`,t)),s(Q(`FOCUS_LISTENER`,t))}}),A(()=>{c()}),{}});function dt(e,t,n){return Je(e,t,[...n||[],nt,Ve,Be,ct,We,ut,Ue,He,$e])}function ft(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n={currentKey:`current`,pageSizeKey:`pageSize`,totalKey:`total`,totalPageKey:`totalPage`},r=w(Te,{}),{pagination:i,...a}=t,{currentKey:o,pageSizeKey:s,totalKey:c,totalPageKey:l}=Re(n,Ee().pagination||{},r.pagination||{},i||{}),u=Re({defaultParams:[{[o]:1,[s]:10}]},a),{data:d,params:f,run:p,...m}=dt(e,u),h=e=>{let[t,...n]=f.value||[],r=[{...t,...e},...n];p(...r)},g=e=>{h({[o]:e})},_=e=>{h({[s]:e})},v=(e,t)=>{h({[o]:e,[s]:t})},y=B(()=>Me(d.value,c,0)),b=B({get:()=>f.value?.[0]?.[o]??u.defaultParams[0][o],set:e=>{g(e)}}),x=B({get:()=>f.value?.[0]?.[s]??u.defaultParams[0][s],set:e=>{_(e)}}),S=B(()=>Me(d.value,l,Math.ceil(y.value/x.value)));return{data:d,params:f,current:b,pageSize:x,total:y,totalPage:S,run:p,changeCurrent:g,changePageSize:_,changePagination:v,...m}}var pt=re(te()),mt=le(),ht=se({props:[`bordered`,`hiddenFilter`,`url`,`columns`,`actions`,`button`,`items`,`model`,`resKey`,`scroll`,`rowSelection`,`isExportExcel`,`isLoadding`,`rowKey`,`buttons`],emits:[`onDeleteAll`,`onExportExcel`],setup(e,{emit:t}){let{data:n,run:r,loading:i,current:a,pageSize:o,total:s,refresh:c}=ft(e.url,{manual:!1,pagination:{pageSizeKey:`pageSize`,currentKey:`page`,totalKey:`totalItems`,totalPageKey:`totalPages`}});console.log(s);let l=I([]),u=e=>{l.value=e},d=()=>{l.value=[]},f=()=>{t(`onDeleteAll`,L(h.value.selectedRowKeys))},p=(e,t)=>e.type===`activate`?t.is_active?`Deactivate`:`Activate`:e.label,m=(e,t)=>e.type===`activate`?t.is_active?`CheckOutlined`:`CloseOutlined`:e.type===`custom`?e.iconCustom||`EyeOutlined`:e.type===`edit`?`EditOutlined`:`DeleteOutlined`,h=B(()=>({selectedRowKeys:l.value,onChange:u})),g=B(()=>e.bordered??!0),_=B(()=>(console.log(`listData`,L(n.value)),L(n.value)?.items||[])),v=B(()=>({total:s.value,current:a.value,pageSize:o.value,showQuickJumper:!0,showSizeChanger:!0,showTotal:()=>oe(`span`,{},`Total ${s.value} record`)})),y=(e,t,n)=>{r({pageSize:e.pageSize,page:e?.current,sort_by:n.field,order:n.order==null?void 0:n.order==`descend`?`desc`:`asc`,...t})},b=B(()=>(L(e.actions)||[]).map(e=>{let{popConfirm:t}=e;return{type:`link`,...e,...t||{},enable:!!t,permission:!0}})),x=B(()=>e.model),S=B(()=>e.button),C=B(()=>e.items),w=B(()=>e.buttons);return{dataSource:_,loading:i,pagination:v,hasBordered:g,handleTableChange:y,run:r,refresh:c,getActions:b,tableFilterModel:x,tableFilterButton:S,tableFilterItems:C,tableActionButtons:w,onSearch:()=>{let e=L(x.value)||{};console.log(`args`,e),e&&Object.keys(e).map(t=>{e[t]&&pt.default.isDayjs(e[t])&&(e[t]=_e(e[t]))}),console.log(`onSearch`,{page:a.value,pageSize:o.value,...e}),r({page:a.value,pageSize:o.value,...e})},formatDate:(e,t=`date`)=>{if(e===`-`)return`-`;let n=t===`date`?_e:ge;return e.length===10?n(Number(e)*1e3):n(e)},rowSelection:h,onDeselect:d,getActionLabel:p,getActionIcon:m,openDetail:e=>{console.log(`record`,e);let t=e.id;t?mt.push(`/app/articles/detail/${t}`):console.warn(`No article found in record:`,e)},onDeleteAll:f,onExportExcel:()=>{t(`onExportExcel`)}}}}),gt={class:`table-component`},_t={key:0},vt={key:1},yt={key:2},bt=[`type`],xt={key:1},St=[`onClick`,`type`];function Ct(n,r,i,a,o,s){let u=Ce,d=he,f=v,p=e,m=t,h=c,g=l;return k(),O(`div`,gt,[x(u,{button:n.tableFilterButton,items:n.tableFilterItems,model:n.tableFilterModel,hiddenFilter:n.hiddenFilter,pagination:null,onOnSearch:n.onSearch,onOnDeselect:n.onDeselect,onOnDeleteAll:n.onDeleteAll,rowSelection:n.rowSelection,isExportExcel:n.isExportExcel,buttons:n.tableActionButtons,onOnExportExcel:n.onExportExcel},null,8,[`button`,`items`,`model`,`hiddenFilter`,`onOnSearch`,`onOnDeselect`,`onOnDeleteAll`,`rowSelection`,`isExportExcel`,`buttons`,`onOnExportExcel`]),x(g,{class:ee([`ant-table-striped`,{border:n.hasBordered}]),rowClassName:(e,t)=>t%2==1?`table-striped`:``,dataSource:n.dataSource,columns:n.columns,rowKey:e=>e[n.rowKey]||e.id,pagination:n.pagination,loading:n.loading||n.isLoadding,onChange:n.handleTableChange,scroll:n.scroll,"row-selection":n.rowSelection},{bodyCell:E(({column:e,text:t,index:r,record:i})=>[e.key===`toIndex`?(k(),O(`span`,_t,R(r+1),1)):z(``,!0),e.key===`toDate`?(k(),O(`span`,vt,R(t?n.formatDate(t):`-`),1)):z(``,!0),e.key===`toDateTime`?(k(),O(`span`,yt,R(t?n.formatDate(t,`time`):`-`),1)):z(``,!0),e.key===`action`?(k(),b(h,{key:3,placement:`topLeft`},{overlay:E(()=>[x(m,{class:`menu-box`},{default:E(()=>[(k(!0),O(N,null,C(n.getActions,(e,t)=>(k(),b(p,{key:`${t}-${e.label}`,style:ne({color:[e.type===`delete`?`red`:`gray`]})},{icon:E(()=>[x(d,{align:`2px`,size:`15px`,style:{"margin-right":`12px`},type:n.getActionIcon(e,i)},null,8,[`type`])]),default:E(()=>[e.enable?(k(),b(f,{key:0,placement:`bottom`,title:e?.title,onConfirm:t=>e?.onConfirm(i),onCancel:t=>e?.onCancel(i)},{default:E(()=>[D(`a`,{onClick:ae(()=>{},[`prevent`]),type:e.type},R(e.label),9,bt)]),_:2},1032,[`title`,`onConfirm`,`onCancel`])):e.permission?(k(),O(`a`,{key:2,onClick:t=>e?.onClick(i),type:e.type},R(n.getActionLabel(e,i)),9,St)):(k(),O(`span`,xt,`——`))]),_:2},1032,[`style`]))),128))]),_:2},1024)]),default:E(()=>[x(d,{align:`2px`,size:`20px`,style:{"margin-left":`5px`},type:`EllipsisOutlined`})]),_:2},1024)):z(``,!0),e.key===`open`?(k(),b(d,{key:4,onClick:e=>n.openDetail(i),align:`2px`,size:`15px`,style:{"margin-left":`5px`},type:`ExportOutlined`},null,8,[`onClick`])):z(``,!0)]),_:1},8,[`class`,`rowClassName`,`dataSource`,`columns`,`rowKey`,`pagination`,`loading`,`onChange`,`scroll`,`row-selection`])])}var wt=r(ht,[[`render`,Ct],[`__scopeId`,`data-v-86a54cbb`]]),Tt=Object.prototype.toString;function Et(e,t){return Tt.call(e)===`[object ${t}]`}function Dt(e){return Et(e,`String`)}function Ot(e){return e===`warning`?x(ue,{class:`modal-icon-warning`},null):e===`success`?x(ie,{class:`modal-icon-success`},null):e===`info`?x(ue,{class:`modal-icon-info`},null):x(F,{class:`modal-icon-error`},null)}function kt({content:e}){return Dt(e)?x(`div`,{innerHTML:`<div>${e}</div>`},null):e}function At(e){let t=e.iconType||`warning`;Reflect.deleteProperty(e,`iconType`);let n={centered:!0,icon:Ot(t),...e,content:kt(e)};return f.confirm(n)}var jt=()=>({okText:`Ok`,centered:!0});function $(e,t){return{...jt(),...e,content:kt(e),icon:Ot(t)}}function Mt(e){return f.success($(e,`success`))}function Nt(e){return f.error($(e,`close`))}function Pt(e){return f.info($(e,`info`))}function Ft(e){return f.warning($(e,`warning`))}ce.config({placement:`topRight`,duration:5});function It(){return{createMessage:pe,notification:ce,createConfirm:At,createSuccessModal:Mt,createErrorModal:Nt,createInfoModal:Pt,createWarningModal:Ft}}export{wt as n,It as t};