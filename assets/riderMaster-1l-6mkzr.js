import"./EyeInvisibleOutlined-BEfU4b7H.js";import{n as e,t}from"./_plugin-vue_export-helper-B7nIStOx.js";import{a as n,i as r,o as i,t as a}from"./input-B6Z8fLJr.js";import{t as o}from"./table-CHoPGXGQ.js";import{r as s,t as c}from"./select-BTuKSqOm.js";import{o as l}from"./Col-DyoQw_cT.js";import"./FolderOutlined-CViWk2Kw.js";import{t as u}from"./modal-LfS8E54v.js";import"./checkbox-B_sO6a1e.js";import{t as d}from"./page-header-DR9ysnSO.js";import{t as f}from"./space-CL3wf0Tc.js";import"./dropdown-CwrvQ9kw.js";import"./breadcrumb-DGazt0_g.js";import"./spin-BgwR0sk-.js";import"./ArrowRightOutlined-C62FZmmk.js";import{t as p}from"./popconfirm-CRcJUvIt.js";import{Dn as m,En as h,Rn as g,Sn as _,Tn as v,Vn as y,Xn as b,bn as x,cr as S,dr as C,gn as w,l as T,nr as E,tr as D,wn as O,xn as k}from"./index-PEy_QorE.js";import{t as A}from"./rider-CIp0TRaq.js";var j={style:{display:`flex`,gap:`8px`,"align-items":`center`}},M={key:1},N=t(m({__name:`index`,setup(t){let m=E(``),N=E([]),P=E(!1),F=E(!1),I=E(!1),L=E(!1),R=D({riderCode:``,name:``,basis:void 0}),z=[{title:`Mã Rider`,dataIndex:`riderCode`,key:`riderCode`},{title:`Tên`,dataIndex:`name`,key:`name`},{title:`Cơ sở`,dataIndex:`basis`,key:`basis`},{title:`Hành động`,key:`action`,fixed:`right`,width:160}],B=x(()=>L.value?`Sửa Rider ${R.riderCode}`:`Tạo Rider mới`);function V(e){H()}async function H(){P.value=!0;try{let e=await A.queryMasters(m.value||void 0);N.value=e.data??e??[]}catch(e){console.error(e),T.error(`Tải danh sách Rider thất bại`)}finally{P.value=!1}}function U(e){e?(L.value=!0,R.riderCode=e.riderCode,R.name=e.name,R.basis=e.basis??void 0):(L.value=!1,R.riderCode=``,R.name=``,R.basis=void 0),F.value=!0}async function W(){I.value=!0;try{if(!R.riderCode||!R.name){T.warn(`Mã và tên là bắt buộc`);return}if(L.value){let e={name:R.name,basis:R.basis??void 0};await A.updateMaster(R.riderCode,e),T.success(`Cập nhật Rider thành công`)}else{let e={riderCode:R.riderCode,name:R.name,basis:R.basis??void 0};await A.createMaster(e),T.success(`Tạo Rider thành công`)}F.value=!1,await H()}catch(e){console.error(e),T.error(e?.message??`Lưu thất bại`)}finally{I.value=!1}}async function G(e){try{await A.deleteMaster(e),T.success(`Xóa thành công`),await H()}catch(e){console.error(e),T.error(e?.message??`Xóa thất bại`)}}return g(()=>H()),(t,g)=>{let x=d,T=r,E=e,D=l,A=p,K=f,q=o,J=a,Y=i,X=c,Z=s,Q=n,$=u;return y(),O(w,null,[h(x,{title:`Quản lý Phụ trợ bảo hiểm`}),h(D,{class:`mb12`},{default:b(()=>[k(`div`,j,[h(T,{value:m.value,"onUpdate:value":g[0]||=e=>m.value=e,placeholder:`Tìm theo mã hoặc tên`,onSearch:V,style:{width:`320px`},allowClear:``},null,8,[`value`]),h(E,{type:`primary`,onClick:g[1]||=e=>U()},{default:b(()=>[...g[7]||=[v(`Tạo Rider`,-1)]]),_:1}),h(E,{onClick:H},{default:b(()=>[...g[8]||=[v(`Làm mới`,-1)]]),_:1})])]),_:1}),h(D,{title:`Danh sách Rider`,class:`mb12`},{default:b(()=>[h(q,{columns:z,dataSource:N.value,rowKey:e=>e.riderCode,pagination:!1,loading:P.value,scroll:{x:1400,y:500}},{bodyCell:b(({column:e,record:t})=>[e.key===`action`?(y(),_(K,{key:0,style:{"justify-content":`flex-end`,width:`100%`}},{default:b(()=>[h(E,{size:`small`,onClick:e=>U(t)},{default:b(()=>[...g[9]||=[v(`Sửa`,-1)]]),_:1},8,[`onClick`]),h(A,{title:`Xóa rider này?`,onConfirm:()=>G(t.riderCode)},{default:b(()=>[h(E,{size:`small`,danger:``},{default:b(()=>[...g[10]||=[v(`Xóa`,-1)]]),_:1})]),_:1},8,[`onConfirm`])]),_:2},1024)):(y(),O(`span`,M,C(t[e.dataIndex]),1))]),_:1},8,[`dataSource`,`rowKey`,`loading`])]),_:1}),h($,{open:F.value,"onUpdate:open":g[5]||=e=>F.value=e,title:S(B),onOk:W,onCancel:g[6]||=e=>F.value=!1,confirmLoading:I.value},{default:b(()=>[h(Q,{layout:`vertical`},{default:b(()=>[h(Y,{label:`Mã Rider`},{default:b(()=>[h(J,{value:R.riderCode,"onUpdate:value":g[2]||=e=>R.riderCode=e,disabled:L.value},null,8,[`value`,`disabled`])]),_:1}),h(Y,{label:`Tên`},{default:b(()=>[h(J,{value:R.name,"onUpdate:value":g[3]||=e=>R.name=e},null,8,[`value`])]),_:1}),h(Y,{label:`Cơ sở tính`},{default:b(()=>[h(Z,{value:R.basis,"onUpdate:value":g[4]||=e=>R.basis=e,allowClear:``},{default:b(()=>[h(X,{value:`per_1000`},{default:b(()=>[...g[11]||=[v(`per_1000`,-1)]]),_:1}),h(X,{value:`per_unit`},{default:b(()=>[...g[12]||=[v(`per_unit`,-1)]]),_:1}),h(X,{value:`percent_of_base`},{default:b(()=>[...g[13]||=[v(`percent_of_base`,-1)]]),_:1})]),_:1},8,[`value`])]),_:1})]),_:1})]),_:1},8,[`open`,`title`,`confirmLoading`])],64)}}}),[[`__scopeId`,`data-v-0964c971`]]);export{N as default};