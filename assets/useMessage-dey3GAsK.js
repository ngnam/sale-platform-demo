import{a as e,u as t}from"./EyeInvisibleOutlined-vBZdbnb5.js";import{n,t as r}from"./_plugin-vue_export-helper-CCMMWqEJ.js";import{a as i,i as a,o,s}from"./input-CE70cYGf.js";import{i as c,t as l}from"./table-Bj7AWOqL.js";import{r as u}from"./select-BktQDR1e.js";import{o as d}from"./Col-B88sKFw0.js";import{t as f}from"./modal-DoGUrgx-.js";import{t as p}from"./checkbox-o3cgUXip.js";import{t as m}from"./space-CGZIuoRS.js";import{n as h,t as g}from"./row-CYcdmHKM.js";import{t as _}from"./date-picker-C5HhZTvF.js";import{t as v}from"./popconfirm-Cd8ZXcgh.js";import{$n as y,An as b,Cn as x,Dn as S,En as C,Jn as w,Mn as T,Rn as ee,Sn as E,Tn as D,Un as O,Vn as k,Xn as A,Yn as j,bn as M,c as N,cn as te,cr as P,d as ne,dr as F,f as re,gn as I,ir as L,kn as ie,l as ae,lr as oe,m as se,mn as ce,mr as le,nr as R,rr as z,tr as ue,ur as de,wn as B,xn as V,y as fe,zn as H}from"./index-DYE8AE99.js";import{t as pe}from"./Icon-wKyRgJuN.js";import{n as me,t as he}from"./dateUtil-JHk6KmED.js";var ge={__name:`index`,props:{modelValue:[String,Number,Object],placeholder:{type:String,default:`Select user`},pageSize:{type:Number,default:10},fetchApiUsers:{type:Function,required:!0},labelKey:{type:String,default:`name`},valueKey:{type:String,default:`id`},mode:{type:String,default:void 0}},emits:[`update:modelValue`],setup(e,{expose:t,emit:n}){let r=e,i=n,a=R(r.modelValue),o=R([]),c=R(!1),l=R(``),d=R(1),f=R(!0);w(()=>r.modelValue,e=>{a.value=e}),ee(async()=>{console.log(`onMounted`),await h()});let p=async e=>{e&&await h()},m=M(()=>o.value.map(e=>({label:e[r.labelKey],value:e[r.valueKey]}))),h=async e=>{l.value=e||null,d.value=1,f.value=!0,o.value=[],await v()};t({refresh:h});let g=s(h,1e3*1),_=async e=>{let{scrollTop:t,scrollHeight:n,clientHeight:r}=e.target;t+r>=n-10&&f.value&&!c.value&&await v()},v=async()=>{c.value=!0;try{let e=await r.fetchApiUsers(l.value,d.value,r.pageSize);Array.isArray(e)&&e.length>0?(o.value.push(...e),f.value=e.length===r.pageSize,d.value+=1):f.value=!1}catch(e){console.error(`Error fetching users:`,e),f.value=!1}finally{c.value=!1}},y=e=>{i(`update:modelValue`,e)};return(t,n)=>{let r=u;return k(),E(r,{value:a.value,"onUpdate:value":n[0]||=e=>a.value=e,placeholder:e.placeholder,"show-search":``,"filter-option":!1,options:P(m),loading:c.value,onSearch:P(g),onPopupScroll:_,onChange:y,mode:e.mode,virtual:!1,onDropdownVisibleChange:p},null,8,[`value`,`placeholder`,`options`,`loading`,`onSearch`,`mode`])}}},_e=S({props:[`hiddenFilter`,`button`,`items`,`model`,`rowSelection`,`isExportExcel`,`buttons`],emits:[`onSearch`,`onDeselect`,`onDeleteAll`,`onExportExcel`],setup(e,{emit:t}){let n=ue(e.model||{}),r=M(()=>(e.items||[]).map(e=>({type:`input`,...e}))),i=M(()=>(e.buttons||[]).map(e=>({type:`default`,...e}))),a=()=>{t(`onSearch`)},o=R(e.hiddenFilter),s=M(()=>e.rowSelection?e.rowSelection.selectedRowKeys:[]);j(()=>{!e.button&&!e.items&&(o.value=!0)});let c=M(()=>({...L(e.button)||{},permission:!0}));return{formModel:n,getItems:r,getButtons:i,hasHidden:o,getButton:c,handleSubmit:a,selectedRowKeys:s,handleDeselect:()=>{t(`onDeselect`)},handleDeleteAll:()=>{t(`onDeleteAll`)},handleExportExcel:()=>{t(`onExportExcel`)}}}}),ve={style:{"margin-left":`16px`,"font-weight":`600`}},ye={key:0,class:`text`};function be(e,t,r,s,c,l){let f=u,v=_,y=p,b=ge,S=n,w=a,ee=o,j=m,M=h,N=g,te=i,P=d;return e.hasHidden?x(``,!0):(k(),E(P,{key:0,"body-style":{marginBottom:`5px`,padding:`24px 24px 0 24px`},bordered:!1},{default:A(()=>[C(te,{class:`form-container`,layout:`horizontal`,model:e.formModel},{default:A(()=>[C(N,{type:`flex`},{default:A(()=>[C(M,{flex:`100px`},{default:A(()=>[C(j,null,{default:A(()=>[(k(!0),B(I,null,O(e.getItems,n=>(k(),E(ee,{key:n.name,name:n.name},{default:A(()=>[n.type===`select`?(k(),E(f,T({key:`select-${n.name}`},{ref_for:!0},n,{value:e.formModel[n.name],"onUpdate:value":t=>e.formModel[n.name]=t,class:`default-select-w`}),null,16,[`value`,`onUpdate:value`])):n.type===`date`?(k(),E(v,T({key:`date-${n.name}`},{ref_for:!0},n,{value:e.formModel[n.name],"onUpdate:value":t=>e.formModel[n.name]=t,class:`default-select-w`}),null,16,[`value`,`onUpdate:value`])):n.type===`checkbox`?(k(),E(y,T({key:`checkbox-${n.name}`},{ref_for:!0},n,{checked:e.formModel[n.name],"onUpdate:checked":t=>e.formModel[n.name]=t,class:`default-select-w`}),{default:A(()=>[D(F(e.formModel[n.name]?`Active`:`Inactive`),1)]),_:2},1040,[`checked`,`onUpdate:checked`])):n.type===`lazyselect`?(k(),E(b,T({key:`lazyselect-${n.name}`,modelValue:e.formModel[n.name],"onUpdate:modelValue":t=>e.formModel[n.name]=t},{ref_for:!0},n,{class:`default-select-w`}),null,16,[`modelValue`,`onUpdate:modelValue`])):(k(),E(w,T({key:4,ref_for:!0},n,{key:`input-${n.name}`,value:e.formModel[n.name],"onUpdate:value":t=>e.formModel[n.name]=t,onSearch:e.handleSubmit,class:`default-search-w`}),{enterButton:A(()=>[C(S,{type:`primary`},{default:A(()=>[...t[1]||=[D(`Search`,-1)]]),_:1})]),_:1},16,[`value`,`onUpdate:value`,`onSearch`]))]),_:2},1032,[`name`]))),128))]),_:1})]),_:1}),e.selectedRowKeys.length>0?(k(),E(M,{key:0,flex:`auto`,class:`rowS`},{default:A(()=>[V(`span`,ve,F(`${e.selectedRowKeys.length} Selected`),1),V(`span`,{style:de([{"margin-left":`8px`,"margin-right":`8px`},{"text-decoration":`underline`,color:`#0065BD`,fontWeight:600}]),onClick:t[0]||=(...t)=>e.handleDeselect&&e.handleDeselect(...t)},`Deselect`),C(S,{style:{"margin-left":`8px`},type:`primary`,danger:``,onClick:e.handleDeleteAll},{default:A(()=>[...t[2]||=[D(F(`Delete`),-1)]]),_:1},8,[`onClick`])]),_:1})):x(``,!0),e.button||e.buttons?(k(),E(M,{key:1,flex:`auto`,class:`rowE`,style:{gap:`5px`}},{default:A(()=>[e.button.type===`text`?(k(),B(`span`,ye,F(e.button.label),1)):x(``,!0),e.getButton.permission?(k(),E(S,T({key:1},e.button,{onClick:e.button?.onClick}),{default:A(()=>[D(F(e.button.label),1)]),_:1},16,[`onClick`])):x(``,!0),e.isExportExcel&&e.getButton.permission?(k(),E(S,{key:2,type:`default`,style:{"margin-left":`10px`},onClick:e.handleExportExcel},{default:A(()=>[...t[3]||=[D(`Export to Excel`,-1)]]),_:1},8,[`onClick`])):x(``,!0),(k(!0),B(I,null,O(e.getButtons,e=>(k(),B(I,{key:e.label},[e?(k(),E(S,T({key:0,ref_for:!0},e,{onClick:e?.onClick}),{default:A(()=>[D(F(e.label),1)]),_:2},1040,[`onClick`])):x(``,!0)],64))),128))]),_:1})):x(``,!0)]),_:1})]),_:1},8,[`model`])]),_:1}))}var xe=r(_e,[[`render`,be],[`__scopeId`,`data-v-f466728c`]]),Se={},Ce=Symbol(`GLOBAL_OPTIONS_PROVIDE_KEY`),we=()=>Se,U=e=>e,Te=Object.prototype.toString,Ee=e=>Te.call(e),De=e=>Ee(e)===`[object Object]`,W=e=>Array.isArray(e),G=e=>typeof e==`object`&&!!e,K=e=>e instanceof Function,q=e=>e==null,Oe=typeof window>`u`,ke=()=>Oe||q(window.document?.visibilityState)?!0:window.document.visibilityState===`visible`,Ae=()=>(!Oe&&window.navigator?.onLine)??!0,je=()=>new Promise(()=>{}),Me=function(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,r=t.replace(/\[(\d+)\]/g,`.$1`).split(`.`),i=e;for(let e of r)if(i=Object(i)[e],i===void 0)return n;return i},J=e=>y(e)?e.value:e,Ne=e=>G(e)?Object.assign(W(e)?[]:{},e):e,Y=new Map,Pe=e=>{if(!q(e))return Y.get(e)},Fe=(e,t,n)=>{let r=Y.get(e);r!=null&&r.timer&&clearTimeout(r.timer);let i=setTimeout(()=>Y.delete(e),t);Y.set(e,{...n,timer:i})};function Ie(e,t,n){let r,i,a,o,s,c,l=0,u=!1,d=!1,f=!0,p=!t&&t!==0&&typeof window.requestAnimationFrame==`function`;if(typeof e!=`function`)throw TypeError(`Expected a function`);t=+t||0,G(n)&&(u=!!n.leading,d=`maxWait`in n,a=d?Math.max(+n.maxWait||0,t):a,f=`trailing`in n?!!n.trailing:f);function m(t){let n=r,a=i;return r=i=void 0,l=t,o=e.apply(a,n),o}function h(e,t){return p?(window.cancelAnimationFrame(s),window.requestAnimationFrame(e)):setTimeout(e,t)}function g(e){if(p)return window.cancelAnimationFrame(e);clearTimeout(e)}function _(e){return l=e,s=h(b,t),u?m(e):o}function v(e){let n=e-c,r=e-l,i=t-n;return d?Math.min(i,a-r):i}function y(e){let n=e-c,r=e-l;return c===void 0||n>=t||n<0||d&&r>=a}function b(){let e=Date.now();if(y(e))return x(e);s=h(b,v(e))}function x(e){return s=void 0,f&&r?m(e):(r=i=void 0,o)}function S(){s!==void 0&&g(s),l=0,r=c=i=s=void 0}function C(){return s===void 0?o:x(Date.now())}function w(){return s!==void 0}function T(){let e=Date.now(),n=y(e);if(r=[...arguments],i=this,c=e,n){if(s===void 0)return _(c);if(d)return s=h(b,t),m(c)}return s===void 0&&(s=h(b,t)),o}return T.cancel=S,T.flush=C,T.pending=w,T}function Le(e,t){for(let n in t){if(t[n]===void 0)continue;if(!G(t[n])||!G(e[n])||!(n in e)){e[n]=t[n];continue}(De(t[n])||W(t[n]))&&Le(e[n],t[n])}}function Re(e){let t=Object.assign({},e);var n=[...arguments].slice(1);if(!n.length)return t;for(let e of n)Le(t,e);return t}function ze(e,t,n){let r=!0,i=!0;if(typeof e!=`function`)throw TypeError(`Expected a function`);return G(n)&&(r=`leading`in n?!!n.leading:r,i=`trailing`in n?!!n.trailing:i),Ie(e,t,{leading:r,trailing:i,maxWait:t})}var Be=U((e,t)=>{let{debounceInterval:n,debounceOptions:r,manual:i}=t,a=R(!1),o=R(),s=M(()=>r),c=M(()=>J(n)),l=R(e.context.runAsync);return i||(a.value=!0),j(t=>{q(c.value)||(o.value=Ie(e=>e(),c.value,s.value),e.context.runAsync=function(){var e=[...arguments];return new Promise((t,n)=>{a.value?(a.value=!1,l.value(...e).then(t).catch(n)):o.value(()=>{l.value(...e).then(t).catch(n)})})},t(()=>{var t;(t=o.value)==null||t.cancel(),e.context.runAsync=l.value}))}),{onCancel(){var e;(e=o.value)==null||e.cancel()}}}),Ve=U((e,t)=>{let{errorRetryCount:n=0,errorRetryInterval:r=0}=t,i=R(),a=R(0),o=M(()=>J(n)),s=M(()=>J(r)),c=!1,l=()=>{a.value=0},u=M(()=>s.value?s.value:1e3*Math.floor(Math.random()*2**Math.min(a.value,9)+1)),d=()=>{let t,n=o.value===-1,r=a.value<o.value;return(n||r)&&(n||(a.value+=1),t=setTimeout(()=>{c=!0,e.context.refresh()},u.value)),()=>t&&clearTimeout(t)},f=()=>{i.value&&i.value()};return{onBefore(){c||l(),c=!1,f()},onSuccess(){l()},onError(){i.value=d()},onCancel(){l(),f()}}}),He=U((e,t)=>{let{ready:n=R(!0),manual:r,defaultParams:i=[]}=t;return w(n,t=>{!r&&t&&e.context.run(...i)},{flush:`sync`}),{onBefore(){if(!(K(n)?n():n.value))return e.loading.value=!1,{isBreak:!0}}}}),Ue=U((e,t)=>{let{refreshDeps:n,refreshDepsAction:r,manual:i}=t;if(n===void 0||W(n)&&n.length===0)return{};let a=W(n)?n:[n];return w(a,()=>{r?r():!i&&e.context.refresh()}),{}}),We=U((e,t)=>{let{throttleInterval:n,throttleOptions:r}=t,i=R(),a=M(()=>J(n)),o=M(()=>r),s=R(e.context.runAsync);return j(t=>{if(q(n))return{};i.value=ze(e=>e(),a.value,o.value),e.context.runAsync=function(){var e=[...arguments];return new Promise((t,n)=>{i.value(()=>{s.value(...e).then(t).catch(n)})})},t(()=>{var t;(t=i.value)==null||t.cancel(),e.context.runAsync=s.value})}),{onCancel(){var e;(e=i.value)==null||e.cancel()}}}),Ge=(e,t)=>n=>{Object.keys(n).forEach(t=>{e[t].value=n[t]}),t.forEach(t=>t(e))},Ke=(e,t)=>()=>{let n=t;for(let t=e.length;t-- >0;)n=e[t](n);return n()},qe=(e,t,n)=>{let{initialData:r,onSuccess:i,onError:a,onBefore:o,onAfter:s}=t,c=R(n?.loading??!1),l=z(n?.data??r),u=z(n?.error),d=R(n?.params),f=R([]),p=z(`pending`),m={},h=Ge({status:p,loading:c,data:l,error:u,params:d},[]),g=function(e){var t=[...arguments].slice(1);if(e===`onQuery`){let e=f.value.map(e=>e.onQuery).filter(Boolean);return{servicePromise:Ke(e,t[0])()}}else{let n=f.value.map(n=>n[e]?.call(n,...t));return Object.assign({},...n)}},_=R(0);return m.runAsync=async function(){var t=[...arguments];h({loading:!0,params:t,status:`pending`}),_.value+=1;let n=_.value,{isBreak:r,breakResult:c=je()}=g(`onBefore`,t);if(r)return h({status:`settled`}),c;o?.(t);try{let r=()=>new Promise(t=>t(e(...d.value))),{servicePromise:a}=g(`onQuery`,r);a||=r();let o=await a;return n===_.value?(h({data:o,loading:!1,error:void 0,status:`settled`}),g(`onSuccess`,o,t),i?.(o,t),n===_.value&&g(`onAfter`,t,o,void 0),s?.(t),o):je()}catch(e){if(n!==_.value)return je();throw h({loading:!1,error:e,status:`settled`}),g(`onError`,e,t),a?.(e,t),n===_.value&&g(`onAfter`,t,void 0,e),s?.(t),e}},m.run=function(){m.runAsync(...arguments).catch(e=>{a||console.error(e)})},m.cancel=()=>{_.value+=1,h({loading:!1}),g(`onCancel`)},m.refresh=()=>{m.run(...d.value||[])},m.refreshAsync=()=>m.runAsync(...d.value||[]),m.mutate=e=>{let t=K(e)?e(l.value):e,n=Ne(t);h({data:n}),g(`onMutate`,n)},{status:p,loading:c,data:l,error:u,params:d,plugins:f,context:m}};function Je(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=b(Ce,{}),i={...we(),...r,...t},{manual:a=!1,defaultParams:o=[]}=i,s=qe(e,i);if(s.plugins.value=n.map(e=>e(s,i)),!a){let e=s.params.value||o;s.context.run(...e)}return H(()=>{s.context.cancel()}),{loading:s.loading,data:s.data,error:s.error,params:s.params,cancel:s.context.cancel,refresh:s.context.refresh,refreshAsync:s.context.refreshAsync,mutate:s.context.mutate,run:s.context.run,runAsync:s.context.runAsync}}var X=new Map,Ye=(e,t)=>{X.set(e,t),t.then(t=>(X.delete(e),t)).catch(()=>{X.delete(e)})},Xe=e=>X.get(e),Z=new Map,Ze=(e,t)=>{Z.has(e)&&Z.get(e).forEach(e=>e(t))},Qe=(e,t)=>(Z.has(e)?Z.get(e).push(t):Z.set(e,[t]),()=>{let n=Z.get(e).indexOf(t);Z.get(e).splice(n,1)}),$e=U((e,t)=>{let{cacheKey:n,cacheTime:r=6e5,staleTime:i=0,getCache:a,setCache:o}=t;if(!n)return{};let s=K(n)?n:()=>n,c=R(()=>{}),l,u=e=>a?a(e):Pe(e),d=(e,t,n)=>{o?o(e,n):Fe(e,t,n),Ze(e,n.data)},f=e=>i===-1||e+i>new Date().getTime(),p=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),m=t=>{let n=s(t);return Qe(n,t=>{e.data.value=t})},h=s(),g=u(h);return g&&p(g,`data`)&&(e.data.value=g.data,e.params.value=g.params),h&&(c.value=m()),H(()=>{c.value()}),{onBefore(t){let n=s(t),r=u(n);if(!r||!p(r,`data`))return{};if(f(r.time))return e.data.value=r.data,e.loading.value=!1,{isBreak:!0,breakResult:r.data};e.data.value=r.data},onQuery(t){let n=e.params.value,r=s(n),i=Xe(r);return i&&i!==l?()=>i:(i=t(),l=i,Ye(r,i),()=>i)},onSuccess(e,t){let n=s(t);n&&(c.value(),d(n,r,{data:e,params:t,time:new Date().getTime()}),c.value=m(t))},onMutate(t){let n=s(e.params.value);n&&(c.value(),d(n,r,{data:t,params:e.params.value,time:new Date().getTime()}),c.value=m(e.params.value))}}});function et(e){let t,n;class r extends Promise{constructor(e){super(e),this.cancel=()=>{n(),clearTimeout(t)}}}return new r(r=>{n=r,t=setTimeout(n,e)})}function tt(){return new Date().getTime()}var nt=U((e,t)=>{let{loadingDelay:n=0,loadingKeep:r=0}=t,i=R(()=>{}),a=M(()=>J(n)),o=M(()=>J(r)),s=0,c={},l=()=>{let t;return a.value&&(t=setTimeout(()=>{e.status.value===`pending`&&(e.loading.value=!0)},a.value)),()=>t&&clearTimeout(t)};return{onBefore(){e.loading.value=!a.value,i.value(),i.value=l(),s=tt()},onQuery(e){if(!o.value)return()=>e();c=et(o.value+a.value);let t=Promise.allSettled([(async()=>{try{let t=await e();return tt()-s<=a.value&&c.cancel(),Promise.resolve(t)}catch(e){return tt()-s<=a.value&&c.cancel(),Promise.reject(e)}})(),c]).then(e=>{let t=e[0];return t.status===`fulfilled`?t.value:Promise.reject(t.reason)});return()=>t},onCancel(){i.value()},onAfter(){i.value()}}}),rt,it=new Set,at=new Set,ot=new Set,Q=(e,t)=>{let n;switch(e){case`FOCUS_LISTENER`:n=it;break;case`RECONNECT_LISTENER`:n=ot;break;case`VISIBLE_LISTENER`:n=at;break}if(!n.has(t))return n.add(t),()=>{n.delete(t)}},st=e=>{e.forEach(e=>{e()})};!Oe&&(rt=window)!=null&&rt.addEventListener&&(window.addEventListener(`visibilitychange`,()=>{ke()&&st(at)},!1),window.addEventListener(`focus`,()=>st(it),!1),window.addEventListener(`online`,()=>st(ot),!1));var ct=U((e,t)=>{let{pollingInterval:n,pollingWhenHidden:r=!1,pollingWhenOffline:i=!1,errorRetryCount:a=0}=t,o=R(),s=R(!1),c=M(()=>J(n)),l=M(()=>J(a)),u=[],d=e=>{e&&u.push(e)},f=()=>(r||ke())&&(i||Ae()),p=t=>{if(e.error.value&&l.value!==0)return;let n;if(!q(c.value)&&c.value>=0)if(f())n=setTimeout(t,c.value);else{s.value=!0;return}return()=>n&&clearTimeout(n)},m=()=>{s.value&&f()&&(e.context.refresh(),s.value=!1)};return w(c,()=>{o.value&&=(o.value(),p(()=>e.context.refresh()))}),r||d(Q(`VISIBLE_LISTENER`,m)),i||d(Q(`RECONNECT_LISTENER`,m)),H(()=>{u.forEach(e=>e())}),{onBefore(){var e;(e=o.value)==null||e.call(o)},onCancel(){var e;(e=o.value)==null||e.call(o)},onAfter(){o.value=p(()=>e.context.refresh())}}}),lt=(e,t)=>{let n=!1;return function(){n||(n=!0,e(...arguments),setTimeout(()=>{n=!1},t))}},ut=U((e,t)=>{let{refreshOnWindowFocus:n=!1,refocusTimespan:r=5e3}=t,i=M(()=>J(n)),a=M(()=>J(r)),o=[],s=e=>{e&&o.push(e)},c=()=>{o.forEach(e=>e())};return j(()=>{if(c(),i.value){let t=lt(e.context.refresh,a.value);s(Q(`VISIBLE_LISTENER`,t)),s(Q(`FOCUS_LISTENER`,t))}}),H(()=>{c()}),{}});function dt(e,t,n){return Je(e,t,[...n||[],nt,Ve,Be,ct,We,ut,Ue,He,$e])}function ft(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n={currentKey:`current`,pageSizeKey:`pageSize`,totalKey:`total`,totalPageKey:`totalPage`},r=b(Ce,{}),{pagination:i,...a}=t,{currentKey:o,pageSizeKey:s,totalKey:c,totalPageKey:l}=Re(n,we().pagination||{},r.pagination||{},i||{}),u=Re({defaultParams:[{[o]:1,[s]:10}]},a),{data:d,params:f,run:p,...m}=dt(e,u),h=e=>{let[t,...n]=f.value||[],r=[{...t,...e},...n];p(...r)},g=e=>{h({[o]:e})},_=e=>{h({[s]:e})},v=(e,t)=>{h({[o]:e,[s]:t})},y=M(()=>Me(d.value,c,0)),x=M({get:()=>f.value?.[0]?.[o]??u.defaultParams[0][o],set:e=>{g(e)}}),S=M({get:()=>f.value?.[0]?.[s]??u.defaultParams[0][s],set:e=>{_(e)}}),C=M(()=>Me(d.value,l,Math.ceil(y.value/S.value)));return{data:d,params:f,current:x,pageSize:S,total:y,totalPage:C,run:p,changeCurrent:g,changePageSize:_,changePagination:v,...m}}var pt=le(ne()),mt=te(),ht=S({props:[`bordered`,`hiddenFilter`,`url`,`columns`,`actions`,`button`,`items`,`model`,`resKey`,`scroll`,`rowSelection`,`isExportExcel`,`isLoadding`,`rowKey`,`buttons`],emits:[`onDeleteAll`,`onExportExcel`],setup(e,{emit:t}){let{data:n,run:r,loading:i,current:a,pageSize:o,total:s,refresh:c}=ft(e.url,{manual:!1,pagination:{pageSizeKey:`pageSize`,currentKey:`page`,totalKey:`totalItems`,totalPageKey:`totalPages`}});console.log(s);let l=R([]),u=e=>{l.value=e},d=()=>{l.value=[]},f=()=>{t(`onDeleteAll`,L(h.value.selectedRowKeys))},p=(e,t)=>e.type===`activate`?t.is_active?`Deactivate`:`Activate`:e.label,m=(e,t)=>e.type===`activate`?t.is_active?`CheckOutlined`:`CloseOutlined`:e.type===`custom`?e.iconCustom||`EyeOutlined`:e.type===`edit`?`EditOutlined`:`DeleteOutlined`,h=M(()=>({selectedRowKeys:l.value,onChange:u})),g=M(()=>e.bordered??!0),_=M(()=>(console.log(`listData`,L(n.value)),L(n.value)?.items||[])),v=M(()=>({total:s.value,current:a.value,pageSize:o.value,showQuickJumper:!0,showSizeChanger:!0,showTotal:()=>ie(`span`,{},`Total ${s.value} record`)})),y=(e,t,n)=>{r({pageSize:e.pageSize,page:e?.current,sort_by:n.field,order:n.order==null?void 0:n.order==`descend`?`desc`:`asc`,...t})},b=M(()=>(L(e.actions)||[]).map(e=>{let{popConfirm:t}=e;return{type:`link`,...e,...t||{},enable:!!t,permission:!0}})),x=M(()=>e.model),S=M(()=>e.button),C=M(()=>e.items),w=M(()=>e.buttons);return{dataSource:_,loading:i,pagination:v,hasBordered:g,handleTableChange:y,run:r,refresh:c,getActions:b,tableFilterModel:x,tableFilterButton:S,tableFilterItems:C,tableActionButtons:w,onSearch:()=>{let e=L(x.value)||{};console.log(`args`,e),e&&Object.keys(e).map(t=>{e[t]&&pt.default.isDayjs(e[t])&&(e[t]=he(e[t]))}),console.log(`onSearch`,{page:a.value,pageSize:o.value,...e}),r({page:a.value,pageSize:o.value,...e})},formatDate:(e,t=`date`)=>{if(e===`-`)return`-`;let n=t===`date`?he:me;return e.length===10?n(Number(e)*1e3):n(e)},rowSelection:h,onDeselect:d,getActionLabel:p,getActionIcon:m,openDetail:e=>{console.log(`record`,e);let t=e.id;t?mt.push(`/app/articles/detail/${t}`):console.warn(`No article found in record:`,e)},onDeleteAll:f,onExportExcel:()=>{t(`onExportExcel`)}}}}),gt={class:`table-component`},_t={key:0},vt={key:1},yt={key:2},bt=[`type`],xt={key:1},St=[`onClick`,`type`];function Ct(n,r,i,a,o,s){let u=xe,d=pe,f=v,p=t,m=e,h=c,g=l;return k(),B(`div`,gt,[C(u,{button:n.tableFilterButton,items:n.tableFilterItems,model:n.tableFilterModel,hiddenFilter:n.hiddenFilter,pagination:null,onOnSearch:n.onSearch,onOnDeselect:n.onDeselect,onOnDeleteAll:n.onDeleteAll,rowSelection:n.rowSelection,isExportExcel:n.isExportExcel,buttons:n.tableActionButtons,onOnExportExcel:n.onExportExcel},null,8,[`button`,`items`,`model`,`hiddenFilter`,`onOnSearch`,`onOnDeselect`,`onOnDeleteAll`,`rowSelection`,`isExportExcel`,`buttons`,`onOnExportExcel`]),C(g,{class:oe([`ant-table-striped`,{border:n.hasBordered}]),rowClassName:(e,t)=>t%2==1?`table-striped`:``,dataSource:n.dataSource,columns:n.columns,rowKey:e=>e[n.rowKey]||e.id,pagination:n.pagination,loading:n.loading||n.isLoadding,onChange:n.handleTableChange,scroll:n.scroll,"row-selection":n.rowSelection},{bodyCell:A(({column:e,text:t,index:r,record:i})=>[e.key===`toIndex`?(k(),B(`span`,_t,F(r+1),1)):x(``,!0),e.key===`toDate`?(k(),B(`span`,vt,F(t?n.formatDate(t):`-`),1)):x(``,!0),e.key===`toDateTime`?(k(),B(`span`,yt,F(t?n.formatDate(t,`time`):`-`),1)):x(``,!0),e.key===`action`?(k(),E(h,{key:3,placement:`topLeft`},{overlay:A(()=>[C(m,{class:`menu-box`},{default:A(()=>[(k(!0),B(I,null,O(n.getActions,(e,t)=>(k(),E(p,{key:`${t}-${e.label}`,style:de({color:[e.type===`delete`?`red`:`gray`]})},{icon:A(()=>[C(d,{align:`2px`,size:`15px`,style:{"margin-right":`12px`},type:n.getActionIcon(e,i)},null,8,[`type`])]),default:A(()=>[e.enable?(k(),E(f,{key:0,placement:`bottom`,title:e?.title,onConfirm:t=>e?.onConfirm(i),onCancel:t=>e?.onCancel(i)},{default:A(()=>[V(`a`,{onClick:ce(()=>{},[`prevent`]),type:e.type},F(e.label),9,bt)]),_:2},1032,[`title`,`onConfirm`,`onCancel`])):e.permission?(k(),B(`a`,{key:2,onClick:t=>e?.onClick(i),type:e.type},F(n.getActionLabel(e,i)),9,St)):(k(),B(`span`,xt,`——`))]),_:2},1032,[`style`]))),128))]),_:2},1024)]),default:A(()=>[C(d,{align:`2px`,size:`20px`,style:{"margin-left":`5px`},type:`EllipsisOutlined`})]),_:2},1024)):x(``,!0),e.key===`open`?(k(),E(d,{key:4,onClick:e=>n.openDetail(i),align:`2px`,size:`15px`,style:{"margin-left":`5px`},type:`ExportOutlined`},null,8,[`onClick`])):x(``,!0)]),_:1},8,[`class`,`rowClassName`,`dataSource`,`columns`,`rowKey`,`pagination`,`loading`,`onChange`,`scroll`,`row-selection`])])}var wt=r(ht,[[`render`,Ct],[`__scopeId`,`data-v-86a54cbb`]]),Tt=Object.prototype.toString;function Et(e,t){return Tt.call(e)===`[object ${t}]`}function Dt(e){return Et(e,`String`)}function Ot(e){return e===`warning`?C(re,{class:`modal-icon-warning`},null):e===`success`?C(se,{class:`modal-icon-success`},null):e===`info`?C(re,{class:`modal-icon-info`},null):C(fe,{class:`modal-icon-error`},null)}function kt({content:e}){return Dt(e)?C(`div`,{innerHTML:`<div>${e}</div>`},null):e}function At(e){let t=e.iconType||`warning`;Reflect.deleteProperty(e,`iconType`);let n={centered:!0,icon:Ot(t),...e,content:kt(e)};return f.confirm(n)}var jt=()=>({okText:`Ok`,centered:!0});function $(e,t){return{...jt(),...e,content:kt(e),icon:Ot(t)}}function Mt(e){return f.success($(e,`success`))}function Nt(e){return f.error($(e,`close`))}function Pt(e){return f.info($(e,`info`))}function Ft(e){return f.warning($(e,`warning`))}N.config({placement:`topRight`,duration:5});function It(){return{createMessage:ae,notification:N,createConfirm:At,createSuccessModal:Mt,createErrorModal:Nt,createInfoModal:Pt,createWarningModal:Ft}}export{wt as n,It as t};